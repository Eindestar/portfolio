# Восстановление золота из руды
Подготовьте прототип модели машинного обучения для «Цифры». Компания разрабатывает решения для эффективной работы промышленных предприятий.

Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Используйте данные с параметрами добычи и очистки. 

Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

Вам нужно:

1. Подготовить данные;
2. Провести исследовательский анализ данных;
3. Построить и обучить модель.

Чтобы выполнить проект, обращайтесь к библиотекам *pandas*, *matplotlib* и *sklearn.* Вам поможет их документация.

Данные находятся в трёх файлах:
    
gold_industry_train.csv — обучающая выборка;

gold_industry_test.csv — тестовая выборка;

gold_industry_full.csv — исходные данные.

Данные индексируются датой и временем получения информации (признак date). Соседние по времени параметры часто похожи.
Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.
Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.
В вашем распоряжении сырые данные: их просто выгрузили из хранилища. Прежде чем приступить к построению модели, проверьте по нашей инструкции их на корректность.
Инструкция по выполнению проекта

## 1. Подготовить данные
- 1.1. Откройте файлы и изучите их.
- 1.2. Проверьте, что эффективность обогащения рассчитана правильно. Вычислите её на обучающей выборке для признака rougher.output.recovery. Найдите MAE между вашими расчётами и значением признака. Опишите выводы.
- 1.3. Проанализируйте признаки, недоступные в тестовой выборке. Что это за параметры? К какому типу относятся?
- 1.4. Проведите предобработку данных.

## 2. Проанализировать данные
- 2.1. Посмотрите, как меняется концентрация металлов (Au, Ag, Pb) на различных этапах: в сырье, в черновом концентрате, в концентрате после первой очистки и в финальном концентрате. Какие особенности имеют распределения? Опишите выводы.
- 2.2.  Сравните распределения размеров гранул исходного сырья на обучающей и тестовой выборках. Если распределения сильно отличаются друг от друга, оценка модели будет неправильной.
- 2.3. Исследуйте суммарную концентрацию металлов на разных стадиях: в сырье, в черновом концентрате, в концентрате после первой очистки и в финальном концентрате.

## 3. Построить модель
- 3.1. Напишите функцию для вычисления итоговой sMAPE.
- 3.2. Обучите разные модели и оцените их качество кросс-валидацией. Выберите лучшую модель и проверьте её на тестовой выборке. Опишите выводы.

# Выводы
В данной работе нам требовалось подготовить прототип модели машинного обучения для «Цифры». Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. Для этого были Использованы данные с параметрами добычи и очистки.

Работа состоит из 3 частей:
- Подготовка данных
- Проведение исследовательского анализа данных
- Построение и обучение модели.

Для выполния проекта, использовались библиотекам pandas, matplotlib, sklearn и другие. 

## В 1 части Подготовке данных былы изучены данные в трех фаилах:

Исходные данные 19439 строк и 87 столбцов, обучающая выборка состоит из 14579 строк и 87 столбцов. в тестовой выборке 4860 строк но 53 столбца, на 34 столбца меньше чем в других данных. Если по количество строк все сходится то в столбцах явное различие присутствует, ниже попробуем разобрать какие столбцы отсутсвуют.

В каждом датасете присутсвую пропуски, об этом говорилось в условии что "Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже."

все значения в столбцах имееют формат float64, и только data - object

1.2. в данном пункте проверили, что эффективность обогащения рассчитана правильно. Вычислили её на обучающей выборке для признака rougher.output.recovery, найшли MAE между расчётами и значением признака. 
МАЕ равна 9.83758577644259e-15, что практически равно 0, поэтому можно считать что расчётная эффективность обогащения практически равна фактической, это доказывает что расчеты верны.

в пункте 1.3. Проанализировали признаки, недоступные в тестовой выборке. 
из всех признаков которые отсутствуют, нам необходимы только 2 целевых признака: rougher.output.recovery и final.output.recovery.

1.4. Провели предобработку данных, проанализируйте данные, привели столбец дата в нужный формат, проверили на дубликаты и пропуски, удалили из обучающей выборке данные отсутствущие в тестовой выборке, и добавили в тестовую выборку необходимые параметры.

## в 2 части провели анализ данных.

2.1. Рассмотрели как меняется концентрация металлов (Au, Ag, Pb) на различных этапах: в сырье, в черновом концентрате, в концентрате после первой очистки и в финальном концентрате. Проанализировав данные можно увидеть, что концентрация Золота и Свинца увеличились с каждыми этапом обработки. Золото с 8,26 до 44,07, практиески в 5 раз больше, а Свинец с 3,59 до 9,97 в 3 раза больше. Концентрация Серебра же после первой и последующих очисток уменьшилось, возможно серебро изымалось и использовалось в других обработках.

2.2. Сравнили распределение размеров гранул исходного сырья на обучающей и тестовой выборках. По графику видно что распределение размеров гранул в обучающей и тестовой выборке примерно равны, Средние значения так же примерно равны, поэтому проводить какие либо дополнительные корректировки не нужно. 

2.3. Исследовали суммарную концентрацию металлов на разных стадиях: в сырье, в черновом концентрате, в концентрате после первой очистки и в финальном концентрате.
Проведя анализ и построив графики концентраций металлов на разных этапах, мы видим что после каждого этапа очистки суммарная концентрация растет. так же были обнаружены выбросы, которые постарались удалить.

## в 3 пункте построили модель, написали функцию для вычисления итоговой sMAPE, Обучили разные модели и оцените их качество кросс-валидацией. Выбрали лучшую модель Линейную регресию и проверили её на тестовой выборке.
Обученная модель показала final_sMAPE 7.97 а константа 8,84. Можно считать что обученная модель адекватна. 
И ее можно использовать для предсказания коэффициенат восстановления золота из золотосодержащей руды.
