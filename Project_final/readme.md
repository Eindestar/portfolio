# Проект: Построение модели предсказания оттока клиентов  для телекоммуникационной компании "ТелеДом"
# Описание проекта:

Оператор связи «ТелеДом» хочет бороться с оттоком клиентов. Для этого будет предлагать промокоды и специальные условия всем, кто планирует отказаться от услуг связи. 

Чтобы заранее находить таких пользователей, «ТелеДому» нужна модель, которая будет предсказывать, разорвёт ли абонент договор. Команда оператора собрала персональные данные о некоторых клиентах, информацию об их тарифах и услугах. 

Задача — обучить на этих данных модель для прогноза оттока клиентов

# Цель: 
    
Минимальный порог хорошей модели ROC-AUC >= 0.85

# План работы:

Шаг 1. Загрузка данных
- Загрузить данные и выполнить их первичный осмотр.

Шаг 2. Исследовательский анализ и предобработка данных
- Выполнить исследовательский анализ каждого датафрейма и выполнить предобработку. Сделайть выводы об имеющихся признаках.

Шаг 3. Объединение данных
- Объединить выбранные вами признаки в один датафрейм по ключу.

Шаг 4. Исследовательский анализ и предобработка данных объединённого датафрейма
- Выполнить исследовательский анализ объединённого датафрейма, визуализируйте распределения признаков и выполните предобработку. 
- Проведите корреляционный анализ.

Шаг 5. Подготовка данных
- Выполнить подготовку данных для обучения модели. 
- Разделить данные на две выборки, при масштабировании и кодировании учитывать особенности данных и моделей.

Шаг 6. Обучение моделей машинного обучения
- Обучить как минимум две модели. Хотя бы для одной из них подберите как минимум два гиперпараметра.

Шаг 7. Выбор лучшей модели
- Выберите лучшую модель и проверьте её качество на тестовой выборке.

Шаг 8. Общий вывод и рекомендации заказчику
- Сделать общий вывод о проделанной работе: описать основные этапы работы, полученные результаты и дать рекомендации для бизнеса.

# Общий вывод и рекомендации заказчику
Положительным результатом работы должна была получиться модель дающая значение показателя ROC AUC выше уровня в 0.85.
В результате проведенной работы (были обучены разные модели (LogisticRegression, RandomForestClassifier, CatBoostClassifier) с подбором гиперпараметров), была найдена подходящая модель CatBoostClassifier с гиперпараметрами показавшая на тренировочной выборке результат ROC AUC = 0,921, а на тестовой 0,923. Цель работы была достигнута.

В проекте были проведены следующие задачи:
- Загрузка данных
- Исследовательский анализ и предобработка данных
- Объединение данных в общую таблицу
- Исследовательский анализ и предобработка данных на общей таблице данных
- Подготовка данных для обучения
- Обучение моделей машинного обучения
- Выбор лучший модели
- общий вывод и рекомендации заказчику

В процессе исследования были проведены ряд работ:
- Провели анализ данных, рассмотрели значения, пропуски, дубликаты, уникальные значения.
- Построили графики для визуального анализа данных. 
- объединили таблицы в один датасет, добавили два новых признака: ушедшие - оставшиеся клиенты, и количество дней пользования услугами компании, так же были удалены данные которые могли повлиять на обучение, такие как дата заключение договора и дата отключение, а так же индивидуальный индификатор пользователя.
- в данных были обнаружены пропуски. в столбце TotalCharges (общая сумма расходов пользователя) было 11 пропущенных значений, заменили на 0, так как в процессе анализа было обнаружено что это новые пользователи заключившие контракт в  день даты выгрузки данных 01.02.2020 и скорее всего платежи либо еще не провели, либо еще не прошли по базе. Так же были обнаружены пропуски в столбцах (InternetService, OnlineSecurity, OnlineBackup, DeviceProtection, TechSupport, StreamingTV, StreamingMovies, MultipleLines) данные столбцы указывали на наличие подключенных услуг. Так как данные об услугах у клиента отсутсвовали, было решено проставить значение No.
- Проведен анаоиз корреляции
- перед обучение была проведена работа по подготвке данных: Разделение выборки на обучающую и тестовую, кодировка данных и масштабирование. 
- Проведено обучение моделей с подборогом гиперпараметров, и выбрана лучшая модель
- Проверели на тестовой выборке, построили ROC-кривую и матрицу ошибок, а так же проапнализировали важности признаков.

Лучшая модель вышла CatBoostClassifier с гиперпараметрами {'iterations': 500, 'learning_rate': 0.3, 'max_depth': 3}
на тестовой выборке показала ROC AUC = 0,923.

При анализе важности признаков получили высокие значения days 66,37, monthly_charges	8,70 total_charges 7,99. данные о количестве дней пользования и расходы влияют сильнее влияют на предсказание, чем остальные.

Из матрицы ошибок обнаружили, что модель лучше предсказывает клиентов которые остались, чем ушедших клиентов.

Из матрицы ошибок обнаружили, что модель лучше предсказывает клиентов которые остались, чем ушедших клиентов.

- 83,3% - получили правильное определение класса 0 (клиент остался)
- 9,6% - правильное определение класса 1 (клиент ушел)
- 6,0% - ошибочное определение класс 1, метка предсказания - 0 (предсказание клиент остался, по факту ушел)
- 1,1% - ошибочное определение класс 0, метка предсказания - 1 (предсказание клиент ушел, по факту остался)

Важно найти клиентов именно решивших покинуть компанию, так как решив что клиент не уйдет, и не отправив ему код, в итоге потеряем клиента и финансовую выгоду, а так же финансово не выгодно отправить клиенту промокод который не собирался уходить.
Важно найти клиентов именно решивших покинуть компанию, так как решив что клиент не уйдет, и не отправив ему код, в итоге потеряем клиента и финансовую выгоду, а так же финансово не выгодно отправить клиенту промокод который не собирался уходить.

Советы и рекомендации заказчику. 

- Собрать больше данных, и использовать для обучения нейросети
- Добавить новые метрики, особенно финансовые, расчитать выгодность удержания клиента или его оставить, так как если один тратит много, то другой может не пользоваться услугами и тогда затраты на его удержания могут привысить доходы от клиента.
- так же стоит провести опрос среди клиентов, особенно из тех кто рассторгает договор, что клиенту не понравилось, так можно найти новые данные для обучения и улучшения модели
