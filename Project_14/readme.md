# Определение возраста покупателей
# Описание проекта
Сетевой супермаркет «Хлеб-Соль» внедряет систему компьютерного зрения для обработки фотографий покупателей. Фотофиксация в прикассовой зоне поможет определять возраст клиентов, чтобы:

- Анализировать покупки и предлагать товары, которые могут заинтересовать покупателей этой возрастной группы;
- Контролировать добросовестность кассиров при продаже алкоголя.

Необходимо построить модель, которая по фотографии определит приблизительный возраст человека. В нашем распоряжении набор фотографий людей с указанием возраста.

# План по выполнению проекта:

- Проведите исследовательский анализ набора фотографий.
- Подготовьте данные к обучению.
- Обучите нейронную сеть и рассчитайте её качество.

# Анализ обученной модели
Целью работы было построить и обучить свёрточную нейронную сеть на датасете с фотографиями людей, которя поможет определять возраст человека по изображению с камеры. Необходимо добиться значения MAE на тестовой выборке не больше 8.

В нашем распоряжении предоставлен набор фотографий людей с указанием возраста. данный датасет состоит из двух столбцов (file_name - фотографии и real_age - возраст человека на данной фотографии) и 7951 строк.
фоторафии с значение возраста. На фотографиях изображены как обычные люди, так и знаменитости (актеры, спортсмены)
некоторые фотографии искажены: повернуты, присутствуют черные рамки, размазнанное (пиксельное) лицо, или вовсе на фотографиях присутсвуют артефакты.

Была построена нейронная сеть на основе свёрточной сети ResNet50 предобученной на ImageNet. Добавили слой GlobalAveragePooling2D и слой Dense с одним выходом и функцией активации relu. оптимизированы параметры с алгоритмом Adam, где learning_rate = 0.0001. Размер батча: 32 (batch_size=32 в функциях загрузки данных). так же использовал отзеркаливание изображений при помощи параметра horizontal_flip=True. В качестве функции потерь использовалась MSE, метрика качества - MAE.

Для тестирования модели было применено 5 эпох, epochs = 5 в функции train_model, добились MAE 6.9099 на тестовой выборке, что требовалось от цели проекта получить мае меньше 8, а еще лучше меньше 7. Увеличение количество эпох до 7 приводит к переобучению модели, что так же негативно влияет на результат.  

Однако, так как метрика качества - MAE измеряется в абсолютных величинах, то получается, что  модель ошибается в возрасте человека на 6,9 лет. Следовательно для человека с 25 лет это разница не сильно критична (в подборе каких либо товаров), тогда как если человеку 22 года, то система с погрешность в 6,9 лет может указать что клиенту к примеру 15-17 лет и отказать в продаже алкоголя, или наоборот 17 летнему разрешит продажу, что может негативно повлиять на бизнес.

Скорее всего такая погрешность связана с тем что в текущем датасете, фотографий людей школьного возраста и людей за 40 лет меньше чем 20 до 40. а так же из за резких пиков в юбилейные и значимые даты: такие как 1 год, 16, 18 лет. а дальше 20, 30, 40, 50, 60, 70, 80 лет. Если датасет дополнить объектами в тех возрастных категориях, в которых количество фотографий мало, то качество модели будет лучше. 

Таким образом цель проекта была достигнута. Точность предсказания возраста нашей моделью составила 6.9099. Данную модель можно использовать в работе.
